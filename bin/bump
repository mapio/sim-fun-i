#!/bin/bash

what="$1"
if [ -z "$what" ]; then
    echo reverting version
    git checkout -- src/sf/__init__.py
    exit
fi
cat <<EOF | python
import semver
l = {}
g = {}
with open('src/sf/__init__.py') as f:
    exec f.read() in g, l
with open('src/sf/__init__.py', 'w') as f:
    for k, v in l.items():
        if k == 'VERSION': v = semver.bump_${what}(l['VERSION'])
        f.write('{} = {}\n'.format(k, repr(v)))
EOF
